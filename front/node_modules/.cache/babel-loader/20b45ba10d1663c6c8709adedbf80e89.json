{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\louis\\\\Documents\\\\doc\\\\loisirs\\\\interplateau ludique\\\\site FELICITES\\\\front\\\\src\\\\components\\\\auth\\\\login.component.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport PropTypes from 'prop-types';\nimport config from '../../config.json';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass LoginComponent extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    // Si on a reçu un token on le stocke , sinon on redirige vers le back pour l'avoir\n    localStorage.clear('killerToken');\n    localStorage.setItem('admin', 'JOUEUR');\n    localStorage.setItem('validated', false);\n\n    if (this.props.match.params.token) {\n      localStorage.setItem('killerToken', this.props.match.params.token);\n      axios({\n        method: 'get',\n        url: `${config.back_Url}/users/ME`,\n        headers: {\n          Token: localStorage.getItem('killerToken')\n        }\n      }).then(data => {\n        if (data.data.status === 200) {\n          localStorage.setItem('userId', data.data.object.id);\n          localStorage.setItem('teamId', data.data.object.teamId);\n          localStorage.setItem('username', data.data.object.username);\n          localStorage.setItem('admin', data.data.object.admin);\n          localStorage.setItem('faction', data.data.object.faction);\n          this.props.history.push('/');\n          window.location.reload();\n        }\n      });\n    } else {\n      const alteredPath = this.props.location.state ? this.props.location.state.from.pathname.replace(/\\//g, '&$$&') : this.props.match.url.replace(/\\//g, '&$$&');\n      window.location.assign(`${config.back_Url}/auth/login/${alteredPath}`);\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Vous allez \\xEAtre redirig\\xE9\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nLoginComponent.propTypes = {\n  match: PropTypes.shape({\n    url: PropTypes.shape({\n      replace: PropTypes.func\n    }),\n    params: PropTypes.shape({\n      token: PropTypes.string\n    }).isRequired\n  }).isRequired,\n  history: PropTypes.shape({\n    push: PropTypes.func\n  }).isRequired,\n  location: PropTypes.shape({\n    state: PropTypes.shape({\n      from: PropTypes.shape({\n        pathname: PropTypes.shape({\n          replace: PropTypes.func\n        })\n      })\n    })\n  }).isRequired\n};\nexport default LoginComponent;","map":{"version":3,"sources":["C:/Users/louis/Documents/doc/loisirs/interplateau ludique/site FELICITES/front/src/components/auth/login.component.jsx"],"names":["React","Component","axios","PropTypes","config","LoginComponent","constructor","props","state","componentDidMount","localStorage","clear","setItem","match","params","token","method","url","back_Url","headers","Token","getItem","then","data","status","object","id","teamId","username","admin","faction","history","push","window","location","reload","alteredPath","from","pathname","replace","assign","render","propTypes","shape","func","string","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport PropTypes from 'prop-types';\r\nimport config from '../../config.json';\r\n\r\nclass LoginComponent extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Si on a reçu un token on le stocke , sinon on redirige vers le back pour l'avoir\r\n    localStorage.clear('killerToken');\r\n    localStorage.setItem('admin', 'JOUEUR');\r\n    localStorage.setItem('validated', false);\r\n    if (this.props.match.params.token) {\r\n      localStorage.setItem('killerToken', this.props.match.params.token);\r\n      axios({\r\n        method: 'get',\r\n        url: `${config.back_Url}/users/ME`,\r\n        headers: { Token: localStorage.getItem('killerToken') },\r\n      }).then((data) => {\r\n        if (data.data.status === 200) {\r\n          localStorage.setItem('userId', data.data.object.id);\r\n          localStorage.setItem('teamId', data.data.object.teamId);\r\n          localStorage.setItem('username', data.data.object.username);\r\n          localStorage.setItem('admin', data.data.object.admin);\r\n          localStorage.setItem('faction', data.data.object.faction);\r\n          this.props.history.push('/');\r\n          window.location.reload();\r\n        }\r\n      });\r\n    } else {\r\n      const alteredPath = this.props.location.state\r\n        ? this.props.location.state.from.pathname.replace(/\\//g, '&$$&')\r\n        : this.props.match.url.replace(/\\//g, '&$$&');\r\n\r\n      window.location.assign(`${config.back_Url}/auth/login/${alteredPath}`);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (<div>Vous allez être redirigé</div>);\r\n  }\r\n}\r\n\r\nLoginComponent.propTypes = {\r\n  match: PropTypes.shape({\r\n    url: PropTypes.shape({\r\n      replace: PropTypes.func,\r\n    }),\r\n    params: PropTypes.shape({\r\n      token: PropTypes.string,\r\n    }).isRequired,\r\n\r\n  }).isRequired,\r\n  history: PropTypes.shape({\r\n    push: PropTypes.func,\r\n  }).isRequired,\r\n  location: PropTypes.shape({\r\n    state: PropTypes.shape({\r\n      from: PropTypes.shape({\r\n        pathname: PropTypes.shape({\r\n          replace: PropTypes.func,\r\n        }),\r\n      }),\r\n    }),\r\n  }).isRequired,\r\n};\r\n\r\nexport default LoginComponent;\r\n"]},"metadata":{},"sourceType":"module"}